
<style>
    .form-horizontal .form-group {
        margin-right: 0px;
        margin-left: 0px;
    }


    .modalPosition {
        top: 100px;
    }

    .saveBtn {
        padding: 6px 50px;
    }
    .alertDiv{
        padding: 10px 0;
        text-align: left;
    }

</style>
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        查看
        <small>overview</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="javascript:void(0)"><i class="fa fa-edit"></i> 查看</a></li>
    </ol>
</section>

<!-- Main content -->
<section class="content" ng-controller="zbOverviewController">
    <form role="form" class="form-horizontal" style="">


        <!--基础信息-->
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title">基本信息</h3>
            </div>
            <!-- /.box-header -->
            <!-- form start -->

            <div class="box-body">


                <div class="form-group ">
                    <label for="nameCn" class="col-xs-2 control-label">指标名称(中文)</label>

                    <div class="col-xs-4 ">
                        <input type="text" class="form-control" id="nameCn" ng-model="obj.indexNameCn" readonly="readonly">
                    </div>
                    <label for="indexName" class="col-xs-2 control-label">指标名称(英文)</label>

                    <div class="col-xs-4">
                        <input type="text" class=" form-control" id="indexName" ng-model="obj.indexName" readonly="readonly">
                    </div>

                </div>

                <div class="form-group">
                    <label for="product" class="col-xs-2 control-label">产品</label>

                    <div class="col-xs-4 ">

                        <input type="text" class="form-control" id="product" ng-model="obj.product.product" readonly="readonly">
                    </div>
                    <label for="service" class="col-xs-2 control-label">服务</label>

                    <div class="col-xs-4 ">
                        <input type="text" class="form-control" id="service" ng-model="obj.service" readonly="readonly">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-2 control-label">业务/技术</label>

                    <div class="col-xs-4 ">
                        <input type="text" class="form-control" ng-model="obj.baseType.desc" readonly="readonly">
                    </div>
                    <label class="col-xs-2 control-label">详细分类</label>

                    <div class="col-xs-4 ">
                        <input type="text" class="form-control" ng-model="obj.detailType" readonly="readonly">
                    </div>
                </div>

                <div class="form-group">
                    <label  class="col-xs-2 control-label">数据类型</label>

                    <div class="col-xs-4 ">

                        <input type="text" class="form-control" ng-model="obj.dataClassify.desc" readonly="readonly">
                    </div>
                    <label  class="col-xs-2 control-label">数据格式</label>

                    <div class="col-xs-4 ">

                        <input type="text" class="form-control" ng-model="obj.dataType.desc" readonly="readonly">

                    </div>
                </div>

                <div class="form-group">
                    <label  class="col-xs-2 control-label">保存时长(天)</label>

                    <div class="col-xs-4 ">
                        <input type="text" class="form-control"  ng-model="obj.saveDate" readonly="readonly">

                    </div>
                    <label  class="col-xs-2 control-label">单位</label>

                    <div class="col-xs-4 ">

                        <input type="text" class="form-control" ng-model="obj.dataUnit.desc" readonly="readonly">

                    </div>

                </div>

                <div class="form-group">
                    <label  class="col-xs-2 control-label">纵坐标起始值</label>
                    <div class="col-xs-4 ">
                        <input class="form-control" ng-model="obj.ordinate" readonly="readonly">

                    </div>
                    <div class="col-xs-6">


                    </div>

                </div>

            </div>
            <!-- /.box-body -->
            <!--采样信息-->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">采样信息</h3>
                </div>
                <div class="box-body">
                    <div class="form-group">
                        <label   class="col-xs-2 control-label">采样频率</label>

                        <div class="col-xs-4 ">
                            <input type="text" class="form-control" ng-model="obj.frecQuency" readonly="readonly" >
                        </div>
                        <label  class="col-xs-2 control-label">采样方式</label>

                        <div class="col-xs-4 ">

                            <input type="text" class="form-control" ng-model="obj.simplingType.desc" readonly="readonly" >

                        </div>
                    </div>

                    <div class="form-group" ng-show="obj.isSoa &&obj.simplingType==simplingTypeOptions[0]">

                        <label for="soa1" class="col-xs-2 control-label">
                            SOA坐标
                        </label>

                        <div class="col-xs-10">
                            <div class="form-group">
                                <div class="col-xs-4 ">
                                    <input type="text" class="form-control" id="soa1" placeholder="产品线"
                                           ng-model="obj.soa.product" readonly="readonly" >
                                </div>

                                <div class="col-xs-4 ">
                                    <input type="text" class="form-control" id="soa2" placeholder="服务线"
                                          ng-model="obj.soa.service" readonly="readonly" >
                                </div>
                                <div class="col-xs-4 ">
                                    <input type="text" class="form-control" id="soa3" placeholder="方法名"
                                          ng-model="obj.soa.method" readonly="readonly" >
                                </div>

                            </div>


                        </div>


                    </div>

                    <div class="form-group" ng-show="!obj.isSoa && obj.simplingType==simplingTypeOptions[0]">
                        <label  class="col-xs-2 control-label">
                            url
                        </label>

                        <div class="col-xs-6 ">
                            <input type="text" class="form-control"  ng-model="obj.url"  readonly="readonly">
                        </div>
                        <label  class="col-xs-2 control-label">超时时间(ms)</label>
                        <div class="col-xs-2 ">
                            <input type="text" class="form-control"  ng-model="obj.timeOut"  readonly="readonly">
                        </div>
                    </div>

                </div>


            </div>


            <!--标签&标签组信息-->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">标签&标签组</h3>
                </div>
                <div class="box-body">
                    <div class="form-group">
                        <label  class="col-xs-2 control-label">可用标签</label>

                        <div class="col-xs-10">

                            <a href="javascript:void(0)" style="padding-left: 10px;" ng-click="showIntfExample()"><span class="fa  fa-commenting-o"></span>查看接口数据样例</a>
                        </div>


                    </div>

                    <div class="form-group" style="margin:0 10%">
                        <table class="table table-hover table-bordered">
                            <tbody>
                            <tr>
                                <th>中文含义</th>
                                <th>英文名称</th>
                                <th>取值</th>
                            </tr>

                            <tr ng-repeat="item in obj.indexTagDetails track by $index">
                                <td>{{item.tagNameCn}}</td>
                                <td>{{item.tagName}}</td>
                                <td>

                                    <a class="glyphicon glyphicon-eye-open" data-toggle="popover" data-html="true"
                                       data-placement="top"
                                       data-content="{{initTable($index)}}" title="标签取值"
                                       ng-mouseenter="popoverShow($event)"
                                       ng-mouseleave="popoverHide($event)"></a>

                                </td>

                            </tr>
                            </tbody>
                        </table>

                    </div>

                    <div class="form-group">
                        <label class="col-xs-2 control-label">
                             标签组合
                        </label>

                        <div class="col-xs-10" >
                            <a class="fa fa-info-circle"></a>&nbsp;&nbsp;标签组合有先后顺序，请将查询使用更频繁的标签排在组合的前边&nbsp;&nbsp;<a
                                class="fa fa-info-circle"></a>
                        </div>


                    </div>

                    <div class="form-group" style="margin:0 10%" >

                        <table class="table table-hover table-bordered">
                            <tbody>
                            <tr>
                                <th>组合描述(中文)</th>
                                <th>组合描述(英文)</th>

                            </tr>
                            <tr ng-repeat="merged in obj.mergedTags track by $index" ng-init="outIndex = $index">
                                <td>
                                <span ng-repeat="tag1 in merged track by $index" ng-init="tag1Index = $index">

                                    <span class="badge">{{tag1.tagNameCn}}</span> <a class="fa fa-plus"
                                                                                     ng-show="tag1Index!=merged.length-1"></a>
                                </span>

                                </td>
                                <td>
                                <span ng-repeat="tag2 in merged track by $index" ng-init="tag2index = $index">

                                    <span class="badge">{{tag2.tagName}}</span> <a class="fa fa-plus"
                                                                                   ng-show="tag2index!=merged.length-1"></a>
                                </span>

                                </td>

                            </tr>

                            </tbody>
                        </table>

                    </div>

                </div>


            </div>

            <!--报警信息信息-->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">报警信息</h3>
                </div>
                <div class="box-body">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">wiki地址</label>

                        <div class="col-xs-8">
                            <input class="form-control"  ng-model="obj.wikiUrl" readonly="readonly"> </input>

                        </div>
                        <div class="col-xs-2">
                            <a target="_blank" href="{{obj.wikiUrl}}" ng-show="obj.wikiUrl.length > 0"> <span class="glyphicon glyphicon-new-window" ></span>&nbsp;前往</a>

                        </div>

                    </div>
                    <div class="form-group">
                        <label class="col-xs-2 control-label">报警文案</label>

                        <div class="col-xs-10">
                        <textarea class="form-control"  ng-model="obj.alertDesc"  readonly="readonly">


                        </textarea>

                        </div>

                    </div>
                    <div class="form-group">
                        <label class="col-xs-2 control-label">报警规则</label>

                        <div class="col-xs-10">

                        </div>
                    </div>

                    <div class="form-group" style="margin:0px 10%">

                        <div class="col-xs-12">
                            <table class="table table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>时间</th>
                                    <th>类型</th>
                                    <!--<th>标签</th>-->
                                    <th>取值</th>
                                    <th>规则</th>
                                    <th>报警组</th>
                                    <th>操作</th>
                                </tr>

                                </thead>

                                <tbody>
                                <tr ng-repeat="temp in obj.indexAlertDetails track by $index">
                                    <td>{{temp.startTime}} - {{temp.endTime}}</td>
                                    <td>{{temp.type.desc}}</td>
                                    <!--<td>{{temp.tag.tagNameCn}}</td>-->
                                    <td>
                                        {{temp.params.length}}个
                                        <a class="glyphicon glyphicon-eye-open" data-toggle="popover" data-html="true"
                                           data-placement="top"
                                           data-content="{{alertValuesHtmls($index)}}" title="values"
                                           ng-mouseenter="popoverShow($event)"
                                           ng-mouseleave="popoverHide($event)"></a>
                                    </td>
                                    <td ng-bind="alertDesc({{$index}})"></td>
                                    <td>{{temp.alertName}}</td>
                                    <td>
                                        <a class="fa fa-eye" ng-click="updateOneAlert($index)"></a>
                                        <!--<a class="fa fa-remove" ng-click="doDeleteOneAlert($index)"></a>-->

                                    </td>
                                </tr>


                                </tbody>

                            </table>

                        </div>


                    </div>
                </div>


        </div>
        </div>
    </form>

    <!-- 接口样例弹窗 -->
    <div class="modal " id="intfExampleModal">
        <div class="modal-dialog">
            <div class="modal-content modalPosition">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">数据示例</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal">
                        <div class="form-group">
                            {{intfExample.desc}}
                        </div>
                        <div class="form-group" style="max-height: 250px;overflow: auto;" id="intf_example_val_div">
                            <textarea class="form-control" ng-model="intfExample.jsonStr" style="min-height: 200px;" ></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">

                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>


    <!-- 报警信息弹窗 -->
    <!-- 报警信息弹窗 -->
    <div class="modal " id="AlertInfoModal">
        <div class="modal-dialog" style="width:730px;">
            <div class="modal-content modalPosition" id="AlertInfoModal_body">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"  >
                        <span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">{{alertTemp.operation}}报警</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal">
                        <!--时间信息-->
                        <div class="form-group">
                            <label class="control-label col-xs-2">类型</label>
                            <div class="col-xs-3">
                                <select ng-model="alertTemp.type" class="form-control select2 select2Normal tagAlertSelect"
                                        ng-options="obj as obj.desc for obj in alertTypeOptions" style="width: 100%"
                                        ng-change="alertTemp.compareType=compareTypeOptions[0];alertTemp.threshold=['',''];resetAlertSelect2()"
                                        disabled="disabled">
                                </select>

                            </div>
                            <label class="control-label col-xs-1">时间</label>
                            <div class="col-xs-2">
                                <input ng-model="alertTemp.startTime" class="form-control" disabled="disabled"/>

                            </div>
                            <label class="control-label col-xs-1">时 -</label>
                            <div class="col-xs-2">
                                <input ng-model="alertTemp.endTime" class="form-control" disabled="disabled">

                            </div>
                            <label class="control-label col-xs-1" style="text-align: left">时</label>

                        </div>

                        <!--标签信息-->
                        <!--<div class="form-group">
                            <label class="control-label col-xs-2">标签</label>
                            <div class="col-xs-3">
                                <select class="form-control select2 select2Normal" ng-model="alertTemp.tag"
                                        ng-options="theTag as theTag.tagNameCn for theTag in obj.indexTagDetails"
                                        ng-change="alertTemp.tagValues=alertTemp.tag.tagValues;resetAlertSelect2();"
                                        style="width: 100%">
                                </select>

                            </div>
                            <label class="control-label col-xs-1">取值</label>
                            <div class="col-xs-5">
                                <select class="form-control select2 select2Multiple"
                                        ng-model="alertTemp.tagValues" multiple="multiple"
                                        ng-options=" value as value.name for value in alertTemp.tag.tagValues"
                                        style="width: 100%">
                                </select>

                            </div>
                            <div class="col-xs-1" style="padding:7px 7px">
                                <button class="form-control btn-sm btn-primary " ng-click="alertTemp.tagValues=alertTemp.tag.tagValues;resetAlertSelect2();">全选</button>
                            </div>

                        </div>-->

                        <div class="form-group">
                            <label class="control-label col-xs-2">取值</label>
                            <div class="col-xs-10">
                                <!--<button class="btn btn-primary" ng-click="showTempAlertParamsModal()">新增取值或取值组合</button>
                                <button class="btn btn-primary" ng-click="clearAlertTempParams()">清空(共{{alertTemp.params.length}}条)</button>-->
                            </div>


                        </div>

                        <div class="form-group" style="max-height: 122px;overflow: hidden;width: 80%; margin:0px auto 15px auto; border:1px solid #d2d6de;" >
                            <div id="alert_val_div" style="max-height: 120px;overflow: hidden; width:100%">
                                <ul>
                                    <li ng-repeat="obj in alertTemp.params track by $index">{{obj}}</li>

                                </ul>

                            </div>


                        </div>

                        <!--绝对数据信息信息-->
                        <div class="form-group" ng-show="alertTemp.type.code == 0">
                            <label class="control-label col-xs-2">数据</label>
                            <div class="col-xs-4">
                                取最近
                                <input class="form-control" type="text" style="width:30%;display: inline;" ng-model="alertTemp.timeWindow"  readonly="readonly">
                                分钟数据
                                <a  data-toggle="popover" data-placement="top" data-html="true" data-content="若为0,则不进行数据聚合阈值判断">
                                    <span class="fa fa-info-circle"></span>
                                </a>
                            </div>
                            <div class="col-xs-2" ng-show="alertTemp.timeWindow!='0'">
                                <select class="select2 select2Normal form-control"
                                        ng-options=" type as type.desc for type in alertDataTypeOptions"
                                        ng-model="alertTemp.alertDataType"  disabled="disabled">

                                </select>
                            </div>
                            <div class="col-xs-4">

                            </div>

                        </div>
                        <!--相对数据信息信息-->
                        <div class="form-group" ng-show="alertTemp.type.code != 0">
                            <label class="control-label col-xs-2">数据</label>
                            <div class="col-xs-4">
                                取最近
                                <input class="form-control" type="text"  style="width:30%;display: inline;"ng-model="alertTemp.timeWindow" readonly="readonly">
                                分钟数据
                                <a  data-toggle="popover" data-placement="top" data-html="true" data-content="若为0,则不进行数据聚合阈值判断">
                                    <span class="fa fa-info-circle"></span>
                                </a>

                            </div>

                            <div class="col-xs-2" ng-show="alertTemp.timeWindow !='0'">
                                <select class="select2 select2Normal form-control"
                                        ng-options=" type as type.desc for type in alertDataTypeOptions"
                                        ng-model="alertTemp.alertDataType"  disabled="disabled">

                                </select>
                            </div>
                            <div class="col-xs-4">
                                与
                                <select class="select2 select2Normal form-control" style="width:60%;display: inline;"
                                        ng-options=" type as type.desc for type in relativeTypeOptions"
                                        ng-model="alertTemp.relativeType"  disabled="disabled">g

                                </select>
                                比较
                            </div>
                        </div>


                        <!--绝对阈值信息信息-->
                        <div class="form-group" ng-show="alertTemp.type.code == 0">
                            <label class="control-label col-xs-2">阈值</label>
                            <div class="col-xs-3">
                                <select class="form-control select2 select2Normal" ng-model="alertTemp.compareType"
                                        ng-options=" type as type.desc for type in compareTypeOptions"
                                        ng-change="alertTemp.threshold=['','']";
                                        style="width: 100%" disabled="disabled"  readonly="readonly">

                                </select>

                            </div>
                            <label class="control-label col-xs-1"> </label>
                            <div class="col-xs-2">
                                <input class="form-control" ng-model="alertTemp.threshold[0]" disabled="disabled">

                            </div>
                            <label class="control-label col-xs-1">
                                -
                            </label>
                            <div class="col-xs-2">
                                <input class="form-control" ng-model="alertTemp.threshold[1]" ng-disabled="alertTemp.compareType.desc!='区间'" disabled="disabled">

                            </div>
                            <label class="control-label col-xs-1">

                            </label>
                        </div>

                        <!--相对阈值信息信息-->
                        <div class="form-group" ng-show="alertTemp.type.code != 0">
                            <label class="control-label col-xs-2">阈值</label>
                            <div class="col-xs-3">
                                <select class="form-control select2 select2Normal" ng-model="alertTemp.compareType"
                                        ng-options=" type as type.desc for type in compareTypeOptions"
                                        ng-change="alertTemp.threshold=['','']";
                                        style="width: 100%" disabled="disabled">

                                </select>


                            </div>
                            <label class="control-label col-xs-1">
                               <!--  <a  data-toggle="popover" data-placement="top" data-html="true" data-content="取历史七天平均值">
                                    <span class="fa fa-info-circle"></span>
                                </a> -->
                            </label>


                            <div class="col-xs-2">
                                <input class="form-control" ng-model="alertTemp.threshold[0]" disabled="disabled">

                            </div>
                            <label class="control-label col-xs-1">
                                % -
                            </label>
                            <div class="col-xs-2">
                                <input class="form-control" ng-model="alertTemp.threshold[1]" ng-disabled="alertTemp.compareType.desc!='区间'" disabled="disabled">

                            </div>
                            <label class="control-label col-xs-1">
                                %
                            </label>

                        </div>

                        <!--报警组名称-->
                        <div class="form-group">
                            <label class="control-label col-xs-2">报警组名称</label>
                            <div class="col-xs-9">
                                <input class="form-control" ng-model="alertTemp.alertName" disabled="disabled">
                            </div>
                            <div class="col-xs-1">
                            </div>

                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <!--<button class="btn btn-primary" ng-click="doUpdateOneAlert()" ng-show='alertTemp.operation=="更新"'>更新</button>
                    <button class="btn btn-primary" ng-click="doAddOneAlert()"  ng-show='alertTemp.operation=="新增"'>新增</button>-->
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

</section>